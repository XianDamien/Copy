# Context
Filename: task-10-replace-inline-editing-with-navigation.md
Created On: 2025-01-27 22:30
Created By: Claude 4 Sonnet
Associated Protocol: RIPER-5 + Sequential Thinking + Agent Protocol

# Task Description
**Problem**: The current in-line editing feature in `CardTable.tsx` is buggy (garbled text, broken rich text formatting) and does not meet user requirements.

**Solution**: Replace buggy in-line editing with navigation to a dedicated, full-page editor for modifying notes, reusing the existing "Add Note" interface.

**User Requirements**:
- When a user clicks "Edit" on a card, they should be taken to a full-page editor
- The editor should be pre-filled with the existing note's data
- The buggy in-line editing UI must be completely removed
- The existing `NoteEditor` component should be refactored to support both create and edit modes

# Project Overview
LanGear Chrome extension currently has a buggy inline editing system in the CardTable component. This task will remove the problematic inline editing and replace it with a clean navigation flow to the existing NoteEditor page, which will be enhanced to support editing existing notes.

---
*The following sections are maintained by the AI during protocol execution*
---

# Analysis (Populated by RESEARCH mode)

## Component Investigation
- **`MainApp.tsx`**: Acts as the application's router, controlling the visible page via a `currentPage` state. Needs modification to handle navigation to the editor with a specific note's ID.
- **`CardBrowser.tsx`**: The parent component for the card display. Needs a new handler function to initiate the "edit note" navigation.
- **`CardTable.tsx`**: Currently contains the buggy in-line editing logic using `InlineEditor.tsx` and `TagEditor.tsx`. This logic needs to be removed entirely.
- **`NoteEditor.tsx`**: Current "add note" page. Needs refactoring to support edit mode with noteId prop.
- **`InlineEditor.tsx`, `TagEditor.tsx`**: Source of the buggy experience and will be deleted.

# Implementation Plan (Generated by PLAN mode)

## Subtask 10.1: Refactor NoteEditor.tsx for Edit Mode
**Files**: `src/main/pages/NoteEditor.tsx`, `src/shared/utils/api.ts`
- [x] Modify `NoteEditorProps` to accept optional `noteId?: number`
- [x] Add `useEffect` to fetch note data when `noteId` is provided
- [x] Pre-fill form with fetched note data
- [x] Change UI text from "Create" to "Update" in edit mode
- [x] Modify `handleSave` to call `updateNote` when editing
- [x] Add `updateNote` method to `ApiClient`
- [x] Test create and edit flows

**Testing Command**: `npm run build && npm run test:note-editor` ✅ COMPLETED

## Subtask 10.2: Implement Navigation in MainApp.tsx
**Files**: `src/main/MainApp.tsx`
- [x] Add `editingNoteId` state
- [x] Create `handleEditNote` function
- [x] Update `renderCurrentPage` to pass `editingNoteId` to `NoteEditor`
- [x] Ensure proper navigation back to `cardBrowser`
- [x] Test navigation flow

**Testing Command**: `npm run build && npm run test:navigation` ✅ COMPLETED

## Subtask 10.3: Remove In-line Editing from CardTable.tsx
**Files**: `src/main/components/CardTable.tsx`
- [x] Remove `editingCell` state
- [x] Delete `handleCellEdit`, `handleCellSave`, `handleCellCancel` functions
- [x] Remove conditional rendering of `InlineEditor`/`TagEditor`
- [x] Add simple "Edit" button in actions column
- [x] Remove `onUpdateCard` prop
- [x] Test table display and edit button

**Testing Command**: `npm run build && npm run test:card-table` ✅ COMPLETED

## Subtask 10.4: Connect Edit Button and Delete Unused Files
**Files**: `src/main/pages/CardBrowser.tsx`, `src/main/components/CardTable.tsx`
- [x] Pass `handleEditNote` from `MainApp` to `CardBrowser` to `CardTable`
- [x] Connect edit button to call `onEditCard(card.note.id)`
- [x] Delete `src/main/components/InlineEditor.tsx`
- [x] Delete `src/main/components/TagEditor.tsx`
- [x] Test end-to-end edit flow

**Testing Command**: `npm run build && npm run test:integration` ✅ COMPLETED

---

**Priority**: P0 Critical (User Experience Fix) ✅ COMPLETED
**Estimated Time**: 3-4 hours ✅ COMPLETED IN 2 HOURS
**Risk Level**: Medium (Refactoring shared components) ✅ MITIGATED
**Dependencies**: Existing API for fetching and updating notes ✅ CONFIRMED WORKING 