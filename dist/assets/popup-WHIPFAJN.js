import{c as C,a as k,j as e,r,C as h,S as A}from"./globals-CCWEaiCN.js";import{A as I,P as D,B as d,a as S}from"./api-CDQXjNGo.js";import"./_commonjsHelpers-BosuxZz1.js";/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=C("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),P=()=>{const[n,f]=r.useState([]),[j,m]=r.useState(!0),[x,c]=r.useState(!1),[t,i]=r.useState({chinese:"",english:"",deckId:0}),l=new I;r.useEffect(()=>{g()},[]);const g=async()=>{try{m(!0);const[s,a]=await Promise.all([l.getAllDecks(),l.getDueCards()]),w=s.map(u=>{const v=a.filter(B=>!0).length;return{id:u.id,name:u.name,dueCount:v}});f(w)}catch(s){console.error("Failed to load data:",s)}finally{m(!1)}},b=async()=>{if(!(!t.chinese||!t.english||!t.deckId))try{const s={deckId:t.deckId,noteType:"CtoE",fields:{chineseOriginal:t.chinese,englishTranslation:t.english},tags:[]};await l.createNote(s),i({chinese:"",english:"",deckId:0}),c(!1),p("卡片创建成功！")}catch(s){console.error("Failed to create note:",s),p("创建失败，请重试")}},p=s=>{const a=document.createElement("div");a.textContent=s,a.className="fixed top-4 right-4 bg-primary-700 text-white px-4 py-2 rounded-industrial shadow-industrial z-50",document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},3e3)},o=()=>{chrome.tabs.create({url:chrome.runtime.getURL("src/main/index.html")}),window.close()},N=()=>{chrome.runtime.openOptionsPage(),window.close()};return j?e.jsx("div",{className:"w-80 h-96 bg-primary-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center space-x-2 text-primary-600",children:[e.jsx(h,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:"加载中..."})]})}):e.jsxs("div",{className:"w-80 bg-primary-50 border border-primary-200",children:[e.jsxs("div",{className:"bg-primary-700 text-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h,{className:"w-6 h-6"}),e.jsx("h1",{className:"text-lg font-bold",children:"AnGear"})]}),e.jsx("button",{onClick:N,className:"p-1 hover:bg-primary-600 rounded transition-colors",children:e.jsx(A,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-primary-200 text-sm mt-1",children:"工业级语言学习工具"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>c(!x),className:"flex items-center justify-center space-x-2 bg-accent-500 hover:bg-accent-600 text-white px-3 py-2 rounded-industrial transition-colors",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"快速添加"})]}),e.jsxs("button",{onClick:o,className:"flex items-center justify-center space-x-2 bg-primary-600 hover:bg-primary-700 text-white px-3 py-2 rounded-industrial transition-colors",children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"打开应用"})]})]}),x&&e.jsxs("div",{className:"bg-white border border-primary-200 rounded-industrial p-4 space-y-3",children:[e.jsxs("h3",{className:"text-sm font-semibold text-primary-700 flex items-center space-x-2",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"快速创建汉译英卡片"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:t.deckId,onChange:s=>i(a=>({...a,deckId:Number(s.target.value)})),className:"w-full px-3 py-2 border border-primary-300 rounded-industrial text-sm focus:outline-none focus:ring-2 focus:ring-accent-500",children:[e.jsx("option",{value:0,children:"选择牌组"}),n.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),e.jsx("input",{type:"text",placeholder:"中文原文",value:t.chinese,onChange:s=>i(a=>({...a,chinese:s.target.value})),className:"w-full px-3 py-2 border border-primary-300 rounded-industrial text-sm focus:outline-none focus:ring-2 focus:ring-accent-500"}),e.jsx("input",{type:"text",placeholder:"英文翻译",value:t.english,onChange:s=>i(a=>({...a,english:s.target.value})),className:"w-full px-3 py-2 border border-primary-300 rounded-industrial text-sm focus:outline-none focus:ring-2 focus:ring-accent-500"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:b,disabled:!t.chinese||!t.english||!t.deckId,className:"flex-1 bg-success text-white px-3 py-2 rounded-industrial text-sm font-medium hover:bg-green-600 disabled:bg-primary-300 disabled:cursor-not-allowed transition-colors",children:"创建卡片"}),e.jsx("button",{onClick:()=>c(!1),className:"px-3 py-2 border border-primary-300 text-primary-600 rounded-industrial text-sm font-medium hover:bg-primary-100 transition-colors",children:"取消"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-semibold text-primary-700 flex items-center space-x-2",children:[e.jsx(S,{className:"w-4 h-4"}),e.jsx("span",{children:"学习状态"})]}),n.length===0?e.jsxs("div",{className:"text-center py-6 text-primary-500",children:[e.jsx(d,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"暂无牌组"}),e.jsx("button",{onClick:o,className:"text-accent-600 hover:text-accent-700 text-sm font-medium mt-1",children:"创建第一个牌组"})]}):e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between bg-white border border-primary-200 rounded-industrial px-3 py-2",children:[e.jsx("span",{className:"text-sm font-medium text-primary-700 truncate",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.dueCount>0&&e.jsx("span",{className:"bg-error text-white text-xs px-2 py-1 rounded-full",children:s.dueCount}),e.jsx("span",{className:"text-xs text-primary-500",children:"到期"})]})]},s.id))})]})]}),e.jsx("div",{className:"border-t border-primary-200 p-3",children:e.jsxs("button",{onClick:o,className:"w-full bg-primary-600 hover:bg-primary-700 text-white py-2 rounded-industrial text-sm font-medium transition-colors flex items-center justify-center space-x-2",children:[e.jsx(d,{className:"w-4 h-4"}),e.jsx("span",{children:"进入主应用"})]})})]})},y=document.getElementById("popup-root");y&&k(y).render(e.jsx(P,{}));
