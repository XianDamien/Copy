import{c as $,r as m,j as e,R as Ae,a as Pe,C as Ie,S as Ne}from"./globals-DRH6KC8u.js";import{A as oe,a as le,P as Q,B as G}from"./api-CdrzsIEU.js";import{S as ze}from"./save-CbFMnBkv.js";import"./_commonjsHelpers-BosuxZz1.js";/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=$("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=$("Bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=$("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=$("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=$("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=$("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=$("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=$("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=$("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=$("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=$("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=$("Highlighter",[["path",{d:"m9 11-6 6v3h9l3-3",key:"1a3l36"}],["path",{d:"m22 12-4.6 4.6a2 2 0 0 1-2.8 0l-5.2-5.2a2 2 0 0 1 0-2.8L14 4",key:"14a9rk"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=$("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=$("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=$("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=$("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=$("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=$("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=$("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=$("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=$("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=$("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]);/**
 * @license lucide-react v0.390.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=$("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);let Ye={data:""},Qe=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||Ye,et=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,tt=/\/\*[^]*?\*\/|  +/g,ve=/\n+/g,U=(t,r)=>{let l="",s="",x="";for(let i in t){let p=t[i];i[0]=="@"?i[1]=="i"?l=i+" "+p+";":s+=i[1]=="f"?U(p,i):i+"{"+U(p,i[1]=="k"?"":r)+"}":typeof p=="object"?s+=U(p,r?r.replace(/([^,])+/g,c=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,c):c?c+" "+d:d)):i):p!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),x+=U.p?U.p(i,p):i+":"+p+";")}return l+(r&&x?r+"{"+x+"}":x)+s},V={},De=t=>{if(typeof t=="object"){let r="";for(let l in t)r+=l+De(t[l]);return r}return t},st=(t,r,l,s,x)=>{let i=De(t),p=V[i]||(V[i]=(d=>{let h=0,f=11;for(;h<d.length;)f=101*f+d.charCodeAt(h++)>>>0;return"go"+f})(i));if(!V[p]){let d=i!==t?t:(h=>{let f,C,b=[{}];for(;f=et.exec(h.replace(tt,""));)f[4]?b.shift():f[3]?(C=f[3].replace(ve," ").trim(),b.unshift(b[0][C]=b[0][C]||{})):b[0][f[1]]=f[2].replace(ve," ").trim();return b[0]})(t);V[p]=U(x?{["@keyframes "+p]:d}:d,l?"":"."+p)}let c=l&&V.g?V.g:null;return l&&(V.g=V[p]),((d,h,f,C)=>{C?h.data=h.data.replace(C,d):h.data.indexOf(d)===-1&&(h.data=f?d+h.data:h.data+d)})(V[p],r,s,c),p},at=(t,r,l)=>t.reduce((s,x,i)=>{let p=r[i];if(p&&p.call){let c=p(l),d=c&&c.props&&c.props.className||/^go/.test(c)&&c;p=d?"."+d:c&&typeof c=="object"?c.props?"":U(c,""):c===!1?"":c}return s+x+(p??"")},"");function de(t){let r=this||{},l=t.call?t(r.p):t;return st(l.unshift?l.raw?at(l,[].slice.call(arguments,1),r.p):l.reduce((s,x)=>Object.assign(s,x&&x.call?x(r.p):x),{}):l,Qe(r.target),r.g,r.o,r.k)}let Ee,xe,he;de.bind({g:1});let _=de.bind({k:1});function rt(t,r,l,s){U.p=r,Ee=t,xe=l,he=s}function W(t,r){let l=this||{};return function(){let s=arguments;function x(i,p){let c=Object.assign({},i),d=c.className||x.className;l.p=Object.assign({theme:xe&&xe()},c),l.o=/ *go\d+/.test(d),c.className=de.apply(l,s)+(d?" "+d:"");let h=t;return t[0]&&(h=c.as||t,delete c.as),he&&h[0]&&he(c),Ee(h,c)}return x}}var nt=t=>typeof t=="function",ce=(t,r)=>nt(t)?t(r):t,it=(()=>{let t=0;return()=>(++t).toString()})(),Re=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let r=matchMedia("(prefers-reduced-motion: reduce)");t=!r||r.matches}return t}})(),lt=20,$e=(t,r)=>{switch(r.type){case 0:return{...t,toasts:[r.toast,...t.toasts].slice(0,lt)};case 1:return{...t,toasts:t.toasts.map(i=>i.id===r.toast.id?{...i,...r.toast}:i)};case 2:let{toast:l}=r;return $e(t,{type:t.toasts.find(i=>i.id===l.id)?1:0,toast:l});case 3:let{toastId:s}=r;return{...t,toasts:t.toasts.map(i=>i.id===s||s===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return r.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(i=>i.id!==r.toastId)};case 5:return{...t,pausedAt:r.time};case 6:let x=r.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+x}))}}},ie=[],X={toasts:[],pausedAt:void 0},Z=t=>{X=$e(X,t),ie.forEach(r=>{r(X)})},ct={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ot=(t={})=>{let[r,l]=m.useState(X),s=m.useRef(X);m.useEffect(()=>(s.current!==X&&l(X),ie.push(l),()=>{let i=ie.indexOf(l);i>-1&&ie.splice(i,1)}),[]);let x=r.toasts.map(i=>{var p,c,d;return{...t,...t[i.type],...i,removeDelay:i.removeDelay||((p=t[i.type])==null?void 0:p.removeDelay)||t?.removeDelay,duration:i.duration||((c=t[i.type])==null?void 0:c.duration)||t?.duration||ct[i.type],style:{...t.style,...(d=t[i.type])==null?void 0:d.style,...i.style}}});return{...r,toasts:x}},dt=(t,r="blank",l)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...l,id:l?.id||it()}),se=t=>(r,l)=>{let s=dt(r,t,l);return Z({type:2,toast:s}),s.id},I=(t,r)=>se("blank")(t,r);I.error=se("error");I.success=se("success");I.loading=se("loading");I.custom=se("custom");I.dismiss=t=>{Z({type:3,toastId:t})};I.remove=t=>Z({type:4,toastId:t});I.promise=(t,r,l)=>{let s=I.loading(r.loading,{...l,...l?.loading});return typeof t=="function"&&(t=t()),t.then(x=>{let i=r.success?ce(r.success,x):void 0;return i?I.success(i,{id:s,...l,...l?.success}):I.dismiss(s),x}).catch(x=>{let i=r.error?ce(r.error,x):void 0;i?I.error(i,{id:s,...l,...l?.error}):I.dismiss(s)}),t};var mt=(t,r)=>{Z({type:1,toast:{id:t,height:r}})},xt=()=>{Z({type:5,time:Date.now()})},Y=new Map,ht=1e3,pt=(t,r=ht)=>{if(Y.has(t))return;let l=setTimeout(()=>{Y.delete(t),Z({type:4,toastId:t})},r);Y.set(t,l)},ut=t=>{let{toasts:r,pausedAt:l}=ot(t);m.useEffect(()=>{if(l)return;let i=Date.now(),p=r.map(c=>{if(c.duration===1/0)return;let d=(c.duration||0)+c.pauseDuration-(i-c.createdAt);if(d<0){c.visible&&I.dismiss(c.id);return}return setTimeout(()=>I.dismiss(c.id),d)});return()=>{p.forEach(c=>c&&clearTimeout(c))}},[r,l]);let s=m.useCallback(()=>{l&&Z({type:6,time:Date.now()})},[l]),x=m.useCallback((i,p)=>{let{reverseOrder:c=!1,gutter:d=8,defaultPosition:h}=p||{},f=r.filter(u=>(u.position||h)===(i.position||h)&&u.height),C=f.findIndex(u=>u.id===i.id),b=f.filter((u,w)=>w<C&&u.visible).length;return f.filter(u=>u.visible).slice(...c?[b+1]:[0,b]).reduce((u,w)=>u+(w.height||0)+d,0)},[r]);return m.useEffect(()=>{r.forEach(i=>{if(i.dismissed)pt(i.id,i.removeDelay);else{let p=Y.get(i.id);p&&(clearTimeout(p),Y.delete(i.id))}})},[r]),{toasts:r,handlers:{updateHeight:mt,startPause:xt,endPause:s,calculateOffset:x}}},yt=_`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ft=_`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gt=_`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,bt=W("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${yt} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ft} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${gt} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,jt=_`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Nt=W("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${jt} 1s linear infinite;
`,vt=_`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,wt=_`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Ct=W("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${vt} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${wt} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,kt=W("div")`
  position: absolute;
`,St=W("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Dt=_`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Et=W("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Dt} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Rt=({toast:t})=>{let{icon:r,type:l,iconTheme:s}=t;return r!==void 0?typeof r=="string"?m.createElement(Et,null,r):r:l==="blank"?null:m.createElement(St,null,m.createElement(Nt,{...s}),l!=="loading"&&m.createElement(kt,null,l==="error"?m.createElement(bt,{...s}):m.createElement(Ct,{...s})))},$t=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Mt=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,Tt="0%{opacity:0;} 100%{opacity:1;}",Ft="0%{opacity:1;} 100%{opacity:0;}",Lt=W("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,At=W("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Pt=(t,r)=>{let l=t.includes("top")?1:-1,[s,x]=Re()?[Tt,Ft]:[$t(l),Mt(l)];return{animation:r?`${_(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${_(x)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},It=m.memo(({toast:t,position:r,style:l,children:s})=>{let x=t.height?Pt(t.position||r||"top-center",t.visible):{opacity:0},i=m.createElement(Rt,{toast:t}),p=m.createElement(At,{...t.ariaProps},ce(t.message,t));return m.createElement(Lt,{className:t.className,style:{...x,...l,...t.style}},typeof s=="function"?s({icon:i,message:p}):m.createElement(m.Fragment,null,i,p))});rt(m.createElement);var zt=({id:t,className:r,style:l,onHeightUpdate:s,children:x})=>{let i=m.useCallback(p=>{if(p){let c=()=>{let d=p.getBoundingClientRect().height;s(t,d)};c(),new MutationObserver(c).observe(p,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return m.createElement("div",{ref:i,className:r,style:l},x)},Ht=(t,r)=>{let l=t.includes("top"),s=l?{top:0}:{bottom:0},x=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Re()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(l?1:-1)}px)`,...s,...x}},Ot=de`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ne=16,Bt=({reverseOrder:t,position:r="top-center",toastOptions:l,gutter:s,children:x,containerStyle:i,containerClassName:p})=>{let{toasts:c,handlers:d}=ut(l);return m.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:ne,left:ne,right:ne,bottom:ne,pointerEvents:"none",...i},className:p,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let f=h.position||r,C=d.calculateOffset(h,{reverseOrder:t,gutter:s,defaultPosition:r}),b=Ht(f,C);return m.createElement(zt,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?Ot:"",style:b},h.type==="custom"?ce(h.message,h):x?x(h):m.createElement(It,{toast:h,position:f}))}))},E=I;const we=({onDeckSelect:t,onCreateNote:r,onStartReview:l})=>{const[s,x]=m.useState([]),[i,p]=m.useState(!0),[c,d]=m.useState(!1),[h,f]=m.useState(!1),[C,b]=m.useState(!1),[u,w]=m.useState(null),[o,j]=m.useState({name:"",description:""}),k=new oe;m.useEffect(()=>{D()},[]);const D=async()=>{try{p(!0);const n=await k.getAllDecks(),a=await Promise.all(n.map(async y=>{try{const N=await k.getDeckStatistics(y.id);return{...y,statistics:N}}catch(N){return console.error(`Failed to load statistics for deck ${y.id}:`,N),y}}));x(a)}catch(n){console.error("Failed to load decks:",n)}finally{p(!1)}},g=async()=>{if(o.name.trim())try{await k.createDeck({name:o.name.trim(),description:o.description.trim()||void 0}),await D(),E.success("ç‰Œç»„åˆ›å»ºæˆåŠŸï¼"),L(),d(!1)}catch(n){console.error("Failed to create deck:",n),E.error("åˆ›å»ºç‰Œç»„å¤±è´¥ï¼Œè¯·é‡è¯•")}},M=async()=>{if(!(!u||!o.name.trim()))try{await k.updateDeck(u.id,{name:o.name.trim(),description:o.description.trim()||void 0}),await D(),E.success("ç‰Œç»„æ›´æ–°æˆåŠŸï¼"),L(),f(!1),w(null)}catch(n){console.error("Failed to update deck:",n),E.error("æ›´æ–°ç‰Œç»„å¤±è´¥ï¼Œè¯·é‡è¯•")}},A=async()=>{if(u)try{await k.deleteDeck(u.id),await D(),E.success("ç‰Œç»„åˆ é™¤æˆåŠŸï¼"),b(!1),w(null)}catch(n){console.error("Failed to delete deck:",n),E.error("åˆ é™¤ç‰Œç»„å¤±è´¥ï¼Œè¯·é‡è¯•")}},L=()=>{j({name:"",description:""})},T=()=>{L(),d(!0)},P=n=>{w(n),j({name:n.name,description:n.description||""}),f(!0)},O=n=>{w(n),b(!0)};return i?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center space-x-3 text-primary-600",children:[e.jsx(le,{className:"w-6 h-6 animate-pulse"}),e.jsx("span",{className:"text-lg font-medium",children:"åŠ è½½ç‰Œç»„ä¸­..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900",children:"æˆ‘çš„ç‰Œç»„"}),e.jsxs("p",{className:"text-primary-600 mt-1",children:["å…± ",s.length," ä¸ªç‰Œç»„ï¼Œ",s.reduce((n,a)=>n+(a.statistics?.totalCards||0),0)," å¼ å¡ç‰‡"]})]}),e.jsxs("button",{onClick:T,className:"btn-accent flex items-center space-x-2",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"åˆ›å»ºç‰Œç»„"})]})]}),s.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(G,{className:"w-20 h-20 mx-auto text-primary-400 mb-6"}),e.jsx("h3",{className:"text-xl font-semibold text-primary-900 mb-3",children:"æš‚æ— ç‰Œç»„"}),e.jsx("p",{className:"text-primary-600 mb-8 max-w-md mx-auto",children:"åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªç‰Œç»„å¼€å§‹å­¦ä¹ ä¹‹æ—…ã€‚ç‰Œç»„å¯ä»¥å¸®åŠ©æ‚¨ç»„ç»‡å’Œç®¡ç†å­¦ä¹ å†…å®¹ã€‚"}),e.jsx("button",{onClick:T,className:"btn-primary",children:"åˆ›å»ºç¬¬ä¸€ä¸ªç‰Œç»„"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(n=>e.jsxs("div",{className:"card-industrial-hover p-6 group cursor-pointer",onClick:()=>t?.(n.id),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"text-lg font-semibold text-primary-900 truncate mb-1",children:n.name})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-medium rounded",children:"Basic"}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),r?.(n.id)},className:"p-2 text-accent-500 hover:text-accent-600 hover:bg-accent-100 rounded-lg transition-colors",title:"æ–°å»ºå¡ç‰‡",children:e.jsx(Q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),P(n)},className:"p-2 text-primary-500 hover:text-accent-600 hover:bg-primary-100 rounded-lg transition-colors",title:"ç¼–è¾‘ç‰Œç»„",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),O(n)},className:"p-2 text-primary-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"åˆ é™¤ç‰Œç»„",children:e.jsx(te,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"mb-4",children:[n.description?e.jsx("p",{className:"text-primary-600 text-sm leading-relaxed mb-3",children:n.description}):e.jsx("p",{className:"text-primary-500 text-sm italic mb-3",children:"æš‚æ— æè¿°ä¿¡æ¯"}),n.statistics&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-blue-600 font-medium",children:"æ–°å¡ç‰‡"}),e.jsx("div",{className:"text-sm font-bold text-blue-800",children:n.statistics.newCards||0})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-orange-600 font-medium",children:"å­¦ä¹ ä¸­"}),e.jsx("div",{className:"text-sm font-bold text-orange-800",children:n.statistics.learningCards||0})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-green-600 font-medium",children:"å¾…å¤ä¹ "}),e.jsx("div",{className:"text-sm font-bold text-green-800",children:n.statistics.dueCards||0})]})]}),e.jsxs("button",{onClick:a=>{a.stopPropagation(),l?.(n.id)},disabled:!n.statistics.dueCards||n.statistics.dueCards===0,className:`w-full py-2 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2 ${n.statistics.dueCards&&n.statistics.dueCards>0?"bg-accent-500 hover:bg-accent-600 text-white":"bg-primary-200 text-primary-500 cursor-not-allowed"}`,title:n.statistics.dueCards&&n.statistics.dueCards>0?"å¼€å§‹å¤ä¹ ":"æš‚æ— åˆ°æœŸå¡ç‰‡",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:n.statistics.dueCards&&n.statistics.dueCards>0?`å¤ä¹  (${n.statistics.dueCards})`:"æš‚æ— å¤ä¹ "})]})]})]}),e.jsx("div",{className:"pt-4 border-t border-primary-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-primary-500",children:["åˆ›å»ºäº ",new Date(n.createdAt).toLocaleDateString()]}),e.jsx("div",{className:"flex items-center space-x-1 text-xs text-primary-600",children:e.jsx("span",{children:"ä¸­æ–‡ â†’ English"})})]})})]},n.id))}),c&&e.jsx("div",{className:"modal-overlay",onClick:()=>d(!1),children:e.jsxs("div",{className:"modal-content",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"åˆ›å»ºæ–°ç‰Œç»„"}),e.jsx("button",{onClick:()=>d(!1),className:"text-primary-500 hover:text-primary-700",children:"âœ•"})]}),e.jsxs("div",{className:"modal-body space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"ç‰Œç»„åç§° *"}),e.jsx("input",{type:"text",value:o.name,onChange:n=>j(a=>({...a,name:n.target.value})),placeholder:"è¾“å…¥ç‰Œç»„åç§°",className:"input-industrial",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"æè¿°ï¼ˆå¯é€‰ï¼‰"}),e.jsx("textarea",{value:o.description,onChange:n=>j(a=>({...a,description:n.target.value})),placeholder:"è¾“å…¥ç‰Œç»„æè¿°",rows:3,className:"input-industrial resize-none"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:()=>d(!1),className:"btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:g,disabled:!o.name.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"åˆ›å»º"})]})]})}),h&&u&&e.jsx("div",{className:"modal-overlay",onClick:()=>f(!1),children:e.jsxs("div",{className:"modal-content",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"ç¼–è¾‘ç‰Œç»„"}),e.jsx("button",{onClick:()=>f(!1),className:"text-primary-500 hover:text-primary-700",children:"âœ•"})]}),e.jsxs("div",{className:"modal-body space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"ç‰Œç»„åç§° *"}),e.jsx("input",{type:"text",value:o.name,onChange:n=>j(a=>({...a,name:n.target.value})),placeholder:"è¾“å…¥ç‰Œç»„åç§°",className:"input-industrial",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"æè¿°ï¼ˆå¯é€‰ï¼‰"}),e.jsx("textarea",{value:o.description,onChange:n=>j(a=>({...a,description:n.target.value})),placeholder:"è¾“å…¥ç‰Œç»„æè¿°",rows:3,className:"input-industrial resize-none"})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:()=>f(!1),className:"btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:M,disabled:!o.name.trim(),className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:"ä¿å­˜"})]})]})}),C&&u&&e.jsx("div",{className:"modal-overlay",onClick:()=>b(!1),children:e.jsxs("div",{className:"modal-content",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-900",children:"åˆ é™¤ç‰Œç»„"}),e.jsx("button",{onClick:()=>b(!1),className:"text-primary-500 hover:text-primary-700",children:"âœ•"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(te,{className:"w-8 h-8 text-red-500"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-primary-900 mb-2",children:["ç¡®å®šè¦åˆ é™¤ç‰Œç»„ ",e.jsxs("strong",{children:['"',u.name,'"']})," å—ï¼Ÿ"]}),e.jsx("p",{className:"text-sm text-primary-600",children:"æ­¤æ“ä½œå°†æ°¸ä¹…åˆ é™¤ç‰Œç»„ä¸­çš„æ‰€æœ‰å¡ç‰‡å’Œå­¦ä¹ è®°å½•ï¼Œä¸”æ— æ³•æ’¤é”€ã€‚"})]})]})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{onClick:()=>b(!1),className:"btn-secondary",children:"å–æ¶ˆ"}),e.jsx("button",{onClick:A,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-industrial font-medium transition-colors",children:"åˆ é™¤"})]})]})})]})},qt=({deckId:t,onBack:r,onNoteSaved:l})=>{const[s,x]=m.useState({chinese:"",english:"",pinyin:"",notes:""}),[i,p]=m.useState(!1),[c,d]=m.useState({}),h=new oe,f=()=>{const u={};return s.chinese.trim()||(u.chinese="è¯·è¾“å…¥ä¸­æ–‡å†…å®¹"),s.english.trim()||(u.english="è¯·è¾“å…¥è‹±æ–‡ç¿»è¯‘"),s.chinese.trim()&&!/[\u4e00-\u9fff]/.test(s.chinese)&&(u.chinese="è¯·è¾“å…¥æœ‰æ•ˆçš„ä¸­æ–‡å­—ç¬¦"),s.english.trim()&&!/[a-zA-Z]/.test(s.english)&&(u.english="è¯·è¾“å…¥æœ‰æ•ˆçš„è‹±æ–‡å­—ç¬¦"),d(u),Object.keys(u).length===0},C=async()=>{if(f()){p(!0);try{const u={chinese:s.chinese.trim(),english:s.english.trim(),pinyin:s.pinyin.trim()||void 0,notes:s.notes.trim()||void 0},w={deckId:t,noteType:"CtoE",fields:{CtoE:u},tags:[]};await h.createNote(w),x({chinese:"",english:"",pinyin:"",notes:""}),d({}),l?.(),alert("ç¬”è®°åˆ›å»ºæˆåŠŸï¼")}catch(u){console.error("Failed to create note:",u),alert("åˆ›å»ºç¬”è®°å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{p(!1)}}},b=(u,w)=>{x(o=>({...o,[u]:w})),c[u]&&d(o=>({...o,[u]:""}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:r,className:"flex items-center space-x-2 text-primary-600 hover:text-primary-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"è¿”å›ç‰Œç»„"})]}),e.jsx("div",{className:"h-6 w-px bg-primary-300"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{className:"w-5 h-5 text-primary-500"}),e.jsx("h2",{className:"text-xl font-bold text-primary-900",children:"åˆ›å»ºä¸­è‹±ç¿»è¯‘ç¬”è®°"})]})]}),e.jsxs("button",{onClick:C,disabled:i||!s.chinese.trim()||!s.english.trim(),className:"btn-accent flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ze,{className:"w-4 h-4"}),e.jsx("span",{children:i?"ä¿å­˜ä¸­...":"ä¿å­˜ç¬”è®°"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-industrial p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary-900 mb-4 flex items-center space-x-2",children:[e.jsx("span",{children:"ğŸ‡¨ğŸ‡³"}),e.jsx("span",{children:"ä¸­æ–‡åŸæ–‡"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"ä¸­æ–‡å†…å®¹ *"}),e.jsx("textarea",{value:s.chinese,onChange:u=>b("chinese",u.target.value),placeholder:"è¯·è¾“å…¥ä¸­æ–‡å¥å­æˆ–çŸ­è¯­...",rows:4,className:`input-industrial resize-none ${c.chinese?"border-red-500":""}`}),c.chinese&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.chinese})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"æ‹¼éŸ³ï¼ˆå¯é€‰ï¼‰"}),e.jsx("input",{type:"text",value:s.pinyin,onChange:u=>b("pinyin",u.target.value),placeholder:"ä¾‹å¦‚ï¼šnÇ hÇo",className:"input-industrial"}),e.jsx("p",{className:"text-primary-500 text-xs mt-1",children:"æ·»åŠ æ‹¼éŸ³æœ‰åŠ©äºå‘éŸ³å­¦ä¹ "})]})]})]}),e.jsxs("div",{className:"card-industrial p-6 bg-primary-25",children:[e.jsx("h4",{className:"text-md font-semibold text-primary-900 mb-3",children:"å¡ç‰‡é¢„è§ˆ"}),e.jsx("div",{className:"bg-white rounded-lg border-2 border-dashed border-primary-300 p-4 min-h-[120px] flex items-center justify-center",children:s.chinese?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-primary-900 mb-2",children:s.chinese}),s.pinyin&&e.jsx("p",{className:"text-sm text-primary-600",children:s.pinyin})]}):e.jsx("p",{className:"text-primary-500 text-sm",children:"è¾“å…¥ä¸­æ–‡å†…å®¹åæ˜¾ç¤ºé¢„è§ˆ"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card-industrial p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary-900 mb-4 flex items-center space-x-2",children:[e.jsx("span",{children:"ğŸ‡ºğŸ‡¸"}),e.jsx("span",{children:"è‹±æ–‡ç¿»è¯‘"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"è‹±æ–‡ç¿»è¯‘ *"}),e.jsx("textarea",{value:s.english,onChange:u=>b("english",u.target.value),placeholder:"è¯·è¾“å…¥å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘...",rows:4,className:`input-industrial resize-none ${c.english?"border-red-500":""}`}),c.english&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.english})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-2",children:"å­¦ä¹ ç¬”è®°ï¼ˆå¯é€‰ï¼‰"}),e.jsx("textarea",{value:s.notes,onChange:u=>b("notes",u.target.value),placeholder:"è®°å½•è¯­æ³•è¦ç‚¹ã€ä½¿ç”¨åœºæ™¯ç­‰...",rows:3,className:"input-industrial resize-none"}),e.jsx("p",{className:"text-primary-500 text-xs mt-1",children:"æ·»åŠ ä¸ªäººç¬”è®°æœ‰åŠ©äºè®°å¿†"})]})]})]}),e.jsxs("div",{className:"card-industrial p-6 bg-accent-25",children:[e.jsx("h4",{className:"text-md font-semibold text-primary-900 mb-3",children:"ç­”æ¡ˆé¢„è§ˆ"}),e.jsx("div",{className:"bg-white rounded-lg border-2 border-dashed border-accent-300 p-4 min-h-[120px] flex items-center justify-center",children:s.english?e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg text-primary-900 mb-2",children:s.english}),s.notes&&e.jsxs("div",{className:"text-sm text-primary-600 mt-3 p-2 bg-primary-50 rounded",children:[e.jsx("strong",{children:"ç¬”è®°ï¼š"})," ",s.notes]})]}):e.jsx("p",{className:"text-primary-500 text-sm",children:"è¾“å…¥è‹±æ–‡ç¿»è¯‘åæ˜¾ç¤ºé¢„è§ˆ"})})]})]})]}),e.jsx("div",{className:"bg-primary-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(G,{className:"w-5 h-5 text-primary-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-primary-900 mb-1",children:"å­¦ä¹ æç¤º"}),e.jsxs("ul",{className:"text-sm text-primary-600 space-y-1",children:[e.jsx("li",{children:"â€¢ ä¿å­˜åå°†è‡ªåŠ¨ç”Ÿæˆå¤ä¹ å¡ç‰‡"}),e.jsx("li",{children:"â€¢ ç³»ç»Ÿä¼šæ ¹æ®FSRSç®—æ³•å®‰æ’å¤ä¹ æ—¶é—´"}),e.jsx("li",{children:"â€¢ å»ºè®®æ·»åŠ æ‹¼éŸ³å’Œç¬”è®°ä»¥æé«˜å­¦ä¹ æ•ˆæœ"})]})]})]})})]})},Vt=({deckId:t,onBack:r})=>{const[l,s]=m.useState(t?"loading":"deck-selection"),[x,i]=m.useState(null),[p,c]=m.useState([]),[d,h]=m.useState([]),[f,C]=m.useState(0),[b,u]=m.useState(0),w=new oe;m.useEffect(()=>{t?j(t):o()},[t]);const o=async()=>{try{const a=await w.getAllDecks();c(a)}catch(a){console.error("Failed to load decks:",a)}},j=async(a=null)=>{s("loading"),i(a);try{const y=await w.getDueCards(a||void 0,20);if(y.length===0){s("no-cards");return}const N=[];for(const S of y)try{const q=await w.getNoteById(S.noteId);q&&N.push({...S,note:q})}catch(q){console.error(`Failed to load note for card ${S.id}:`,q)}N.length>0?(h(N),C(0),u(0),s("question")):s("no-cards")}catch(y){console.error("Failed to start review:",y),alert("å¯åŠ¨å¤ä¹ å¤±è´¥ï¼Œè¯·é‡è¯•"),s("deck-selection")}},k=()=>{s("answer")},D=async a=>{const y=d[f];if(y)try{await w.reviewCard(y.id,a==="Again"?1:a==="Hard"?2:a==="Good"?3:4),u(N=>N+1),f<d.length-1?(C(N=>N+1),s("question")):s("completed")}catch(N){console.error("Failed to submit rating:",N),alert("æäº¤è¯„åˆ†å¤±è´¥ï¼Œè¯·é‡è¯•")}},g=()=>{s("deck-selection"),i(null),h([]),C(0),u(0)},M=()=>d[f],A=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary-900",children:"é€‰æ‹©å¤ä¹ å†…å®¹"}),e.jsx("p",{className:"text-primary-600 mt-1",children:"é€‰æ‹©è¦å¤ä¹ çš„ç‰Œç»„æˆ–å¤ä¹ æ‰€æœ‰åˆ°æœŸå¡ç‰‡"})]}),r&&e.jsxs("button",{onClick:r,className:"flex items-center space-x-2 text-primary-600 hover:text-primary-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"è¿”å›"})]})]}),e.jsx("div",{className:"card-industrial p-6 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>j(null),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900 mb-2",children:"å¤ä¹ æ‰€æœ‰åˆ°æœŸå¡ç‰‡"}),e.jsx("p",{className:"text-primary-600",children:"å¤ä¹ æ‰€æœ‰ç‰Œç»„ä¸­çš„åˆ°æœŸå¡ç‰‡"})]}),e.jsx("div",{className:"text-accent-600",children:e.jsx(re,{className:"w-8 h-8"})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"æˆ–é€‰æ‹©ç‰¹å®šç‰Œç»„"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(a=>e.jsxs("div",{className:"card-industrial p-4 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>j(a.id),children:[e.jsx("h4",{className:"font-semibold text-primary-900 mb-1",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-primary-600 mb-2",children:a.description}),e.jsx("div",{className:"text-xs text-primary-500",children:"ç‚¹å‡»å¼€å§‹å¤ä¹ æ­¤ç‰Œç»„"})]},a.id))})]})]}),L=()=>e.jsx("div",{className:"text-center py-16",children:e.jsxs("div",{className:"flex items-center justify-center space-x-3 text-primary-600",children:[e.jsx(fe,{className:"w-8 h-8 animate-spin"}),e.jsx("span",{className:"text-lg font-medium",children:"æ­£åœ¨åŠ è½½å¤ä¹ å¡ç‰‡..."})]})}),T=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx(re,{className:"w-16 h-16 mx-auto text-green-500 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-primary-900 mb-2",children:"æš‚æ— åˆ°æœŸå¡ç‰‡"}),e.jsxs("p",{className:"text-primary-600 mb-6",children:[x?"è¯¥ç‰Œç»„":"æ‰€æœ‰ç‰Œç»„","ä¸­æš‚æ—¶æ²¡æœ‰éœ€è¦å¤ä¹ çš„å¡ç‰‡"]}),e.jsx("button",{onClick:g,className:"btn-primary",children:"é‡æ–°é€‰æ‹©"})]}),P=()=>{const a=M();if(!a)return null;const y=a.note.fields.CtoE?.chinese||"å†…å®¹åŠ è½½å¤±è´¥",N=a.note.fields.CtoE?.pinyin;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:g,className:"flex items-center space-x-2 text-primary-600 hover:text-primary-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"é‡æ–°é€‰æ‹©"})]}),e.jsx("div",{className:"h-6 w-px bg-primary-300"}),e.jsxs("div",{className:"text-sm text-primary-600",children:[f+1," / ",d.length]})]}),e.jsx("div",{className:"flex items-center space-x-2 text-sm text-primary-600",children:e.jsxs("span",{children:["å·²å®Œæˆ: ",b]})})]}),e.jsx("div",{className:"w-full bg-primary-200 rounded-full h-2",children:e.jsx("div",{className:"bg-accent-500 h-2 rounded-full transition-all duration-300",style:{width:`${f/d.length*100}%`}})}),e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"card-industrial p-8 text-center bg-gradient-to-br from-primary-50 to-accent-50 border-2 border-accent-200",children:[e.jsx("div",{className:"mb-4",children:e.jsx("h3",{className:"text-sm font-medium text-primary-600 mb-2",children:"è¯·ç¿»è¯‘ä¸‹é¢çš„ä¸­æ–‡"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-3xl font-bold text-primary-900 leading-relaxed",children:y}),N&&e.jsx("p",{className:"text-lg text-primary-600 font-medium",children:N})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{onClick:k,className:"btn-accent text-lg px-8 py-3",children:"æ˜¾ç¤ºç­”æ¡ˆ"})})]})})]})},O=()=>{const a=M();if(!a)return null;const y=a.note.fields.CtoE?.chinese||"å†…å®¹åŠ è½½å¤±è´¥",N=a.note.fields.CtoE?.english||"ç¿»è¯‘åŠ è½½å¤±è´¥",S=a.note.fields.CtoE?.notes,q=a.note.fields.CtoE?.pinyin;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:g,className:"flex items-center space-x-2 text-primary-600 hover:text-primary-700 transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:"é‡æ–°é€‰æ‹©"})]}),e.jsx("div",{className:"h-6 w-px bg-primary-300"}),e.jsxs("div",{className:"text-sm text-primary-600",children:[f+1," / ",d.length]})]}),e.jsx("div",{className:"flex items-center space-x-2 text-sm text-primary-600",children:e.jsxs("span",{children:["å·²å®Œæˆ: ",b]})})]}),e.jsx("div",{className:"w-full bg-primary-200 rounded-full h-2",children:e.jsx("div",{className:"bg-accent-500 h-2 rounded-full transition-all duration-300",style:{width:`${f/d.length*100}%`}})}),e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{className:"card-industrial p-6 bg-primary-25 border border-primary-200",children:[e.jsx("h4",{className:"text-sm font-medium text-primary-600 mb-2",children:"åŸæ–‡"}),e.jsx("p",{className:"text-xl font-semibold text-primary-900",children:y}),q&&e.jsx("p",{className:"text-md text-primary-600 mt-1",children:q})]}),e.jsxs("div",{className:"card-industrial p-6 bg-accent-25 border border-accent-200",children:[e.jsx("h4",{className:"text-sm font-medium text-accent-700 mb-2",children:"å‚è€ƒç¿»è¯‘"}),e.jsx("p",{className:"text-xl font-semibold text-accent-900",children:N}),S&&e.jsxs("div",{className:"mt-4 p-3 bg-accent-50 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-medium text-accent-700 mb-1",children:"å­¦ä¹ ç¬”è®°"}),e.jsx("p",{className:"text-sm text-accent-800",children:S})]})]}),e.jsxs("div",{className:"card-industrial p-6",children:[e.jsx("h4",{className:"text-center text-lg font-semibold text-primary-900 mb-6",children:"è¯·æ ¹æ®ä½ çš„å›ç­”æƒ…å†µè¯„åˆ†"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>D("Again"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-red-200 hover:border-red-400 hover:bg-red-50 transition-colors",children:[e.jsx(qe,{className:"w-8 h-8 text-red-500 mb-2"}),e.jsx("span",{className:"font-medium text-red-700",children:"Again"}),e.jsx("span",{className:"text-xs text-red-600 text-center",children:"å®Œå…¨ä¸ä¼š"})]}),e.jsxs("button",{onClick:()=>D("Hard"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-yellow-200 hover:border-yellow-400 hover:bg-yellow-50 transition-colors",children:[e.jsx(Xe,{className:"w-8 h-8 text-yellow-500 mb-2"}),e.jsx("span",{className:"font-medium text-yellow-700",children:"Hard"}),e.jsx("span",{className:"text-xs text-yellow-600 text-center",children:"å›°éš¾"})]}),e.jsxs("button",{onClick:()=>D("Good"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-green-200 hover:border-green-400 hover:bg-green-50 transition-colors",children:[e.jsx(re,{className:"w-8 h-8 text-green-500 mb-2"}),e.jsx("span",{className:"font-medium text-green-700",children:"Good"}),e.jsx("span",{className:"text-xs text-green-600 text-center",children:"è‰¯å¥½"})]}),e.jsxs("button",{onClick:()=>D("Easy"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-blue-200 hover:border-blue-400 hover:bg-blue-50 transition-colors",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-500 mb-2"}),e.jsx("span",{className:"font-medium text-blue-700",children:"Easy"}),e.jsx("span",{className:"text-xs text-blue-600 text-center",children:"ç®€å•"})]})]}),e.jsx("div",{className:"mt-4 text-xs text-primary-500 text-center",children:"è¯„åˆ†ä¼šå½±å“ä¸‹æ¬¡å¤ä¹ çš„æ—¶é—´å®‰æ’"})]})]})]})},n=()=>e.jsxs("div",{className:"text-center py-16",children:[e.jsx(re,{className:"w-20 h-20 mx-auto text-green-500 mb-6"}),e.jsx("h3",{className:"text-2xl font-bold text-primary-900 mb-4",children:"å¤ä¹ å®Œæˆï¼"}),e.jsxs("p",{className:"text-lg text-primary-600 mb-2",children:["æœ¬æ¬¡å¤ä¹ äº† ",b," å¼ å¡ç‰‡"]}),e.jsx("p",{className:"text-primary-500 mb-8",children:"ç³»ç»Ÿå·²æ ¹æ®ä½ çš„è¯„åˆ†å®‰æ’ä¸‹æ¬¡å¤ä¹ æ—¶é—´"}),e.jsxs("div",{className:"space-x-4",children:[e.jsx("button",{onClick:g,className:"btn-primary",children:"å†æ¬¡å¤ä¹ "}),r&&e.jsx("button",{onClick:r,className:"btn-secondary",children:"è¿”å›é¦–é¡µ"})]})]});return e.jsxs("div",{className:"space-y-6",children:[l==="deck-selection"&&A(),l==="loading"&&L(),l==="no-cards"&&T(),l==="question"&&P(),l==="answer"&&O(),l==="completed"&&n()]})};function ge(t){if(t instanceof Date)return t;if(typeof t=="string"||typeof t=="number"){const r=new Date(t);return isNaN(r.getTime())?(console.warn("Invalid date value:",t),new Date):r}return console.warn("Invalid date type:",typeof t,t),new Date}function pe(t){const r=ge(t);return`${r.toLocaleDateString("zh-CN")} ${r.toLocaleTimeString("zh-CN")}`}function _t(t){const r=ge(t),l=new Date,s=r.getTime()-l.getTime();return Math.ceil(s/(1e3*60*60*24))}function Me(t){return ge(t)<=new Date?"å·²åˆ°æœŸ":`${_t(t)}å¤©å`}const Kt=({value:t,onSave:r,onCancel:l,placeholder:s="ç‚¹å‡»ç¼–è¾‘...",multiline:x=!1,maxLength:i=500,className:p=""})=>{const[c,d]=m.useState(t),[h,f]=m.useState(!1),[C,b]=m.useState({bold:!1,italic:!1,underline:!1,highlight:!1}),u=m.useRef(null),w=m.useRef(null);m.useEffect(()=>{if(x&&u.current){u.current.focus();const g=document.createRange();g.selectNodeContents(u.current),g.collapse(!1);const M=window.getSelection();M?.removeAllRanges(),M?.addRange(g)}else!x&&w.current&&(w.current.focus(),w.current.select())},[x]);const o=async()=>{if(c.trim()===t.trim()){l();return}if(c.trim().length===0){E.error("å†…å®¹ä¸èƒ½ä¸ºç©º");return}if(c.length>i){E.error(`å†…å®¹é•¿åº¦ä¸èƒ½è¶…è¿‡ ${i} ä¸ªå­—ç¬¦`);return}try{f(!0),await r(c.trim()),E.success("ä¿å­˜æˆåŠŸ")}catch(g){console.error("Save failed:",g),E.error("ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{f(!1)}},j=g=>{g.key==="Enter"&&!g.shiftKey&&!x?(g.preventDefault(),o()):g.key==="Escape"?(g.preventDefault(),l()):g.key==="s"&&(g.ctrlKey||g.metaKey)&&(g.preventDefault(),o())},k=g=>{if(!x)return;const M=window.getSelection();if(!M||M.rangeCount===0)return;const A=M.getRangeAt(0),L=A.toString();if(!L)return;let T;switch(g){case"bold":T=document.createElement("strong");break;case"italic":T=document.createElement("em");break;case"underline":T=document.createElement("u");break;case"highlight":T=document.createElement("mark"),T.style.backgroundColor="#fef08a";break;default:return}try{A.surroundContents(T),b(P=>({...P,[g]:!P[g]})),u.current&&d(u.current.innerHTML)}catch{T.textContent=L,A.deleteContents(),A.insertNode(T),u.current&&d(u.current.innerHTML)}},D=g=>new DOMParser().parseFromString(g,"text/html").body.textContent||"";return x?e.jsxs("div",{className:`border border-accent-300 rounded-lg overflow-hidden ${p}`,children:[e.jsxs("div",{className:"bg-primary-50 border-b border-primary-200 px-3 py-2 flex items-center space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>k("bold"),className:`p-1 rounded transition-colors ${C.bold?"bg-accent-100 text-accent-700":"text-primary-600 hover:bg-primary-100"}`,title:"ç²—ä½“ (Ctrl+B)",children:e.jsx(He,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>k("italic"),className:`p-1 rounded transition-colors ${C.italic?"bg-accent-100 text-accent-700":"text-primary-600 hover:bg-primary-100"}`,title:"æ–œä½“ (Ctrl+I)",children:e.jsx(Ge,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>k("underline"),className:`p-1 rounded transition-colors ${C.underline?"bg-accent-100 text-accent-700":"text-primary-600 hover:bg-primary-100"}`,title:"ä¸‹åˆ’çº¿ (Ctrl+U)",children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:()=>k("highlight"),className:`p-1 rounded transition-colors ${C.highlight?"bg-accent-100 text-accent-700":"text-primary-600 hover:bg-primary-100"}`,title:"é«˜äº®",children:e.jsx(Ke,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex-1"}),e.jsxs("span",{className:"text-xs text-primary-500",children:[D(c).length,"/",i]})]}),e.jsx("div",{ref:u,contentEditable:!0,suppressContentEditableWarning:!0,onInput:g=>d(g.currentTarget.innerHTML),onKeyDown:j,className:"p-3 min-h-[80px] max-h-[200px] overflow-y-auto focus:outline-none focus:ring-2 focus:ring-accent-500 focus:ring-inset",style:{wordBreak:"break-word"},dangerouslySetInnerHTML:{__html:c}}),e.jsxs("div",{className:"bg-primary-50 border-t border-primary-200 px-3 py-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-primary-500",children:"Enter+Shift æ¢è¡Œ â€¢ Ctrl+S ä¿å­˜ â€¢ Esc å–æ¶ˆ"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{type:"button",onClick:l,disabled:h,className:"px-3 py-1 text-sm text-primary-600 hover:text-primary-800 hover:bg-primary-100 rounded transition-colors disabled:opacity-50",children:[e.jsx(B,{className:"w-4 h-4 mr-1 inline"}),"å–æ¶ˆ"]}),e.jsxs("button",{type:"button",onClick:o,disabled:h||D(c).length===0||D(c).length>i,className:"px-3 py-1 text-sm bg-accent-500 text-white hover:bg-accent-600 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[h?e.jsx("div",{className:"w-4 h-4 mr-1 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(me,{className:"w-4 h-4 mr-1"}),"ä¿å­˜"]})]})]})]}):e.jsxs("div",{className:`flex items-center space-x-2 ${p}`,children:[e.jsx("input",{ref:w,type:"text",value:c,onChange:g=>d(g.target.value),onKeyDown:j,placeholder:s,maxLength:i,className:"flex-1 px-2 py-1 border border-accent-300 rounded focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500",disabled:h}),e.jsx("button",{type:"button",onClick:o,disabled:h||c.trim().length===0||c.length>i,className:"p-1 text-accent-600 hover:text-accent-700 hover:bg-accent-50 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"ä¿å­˜ (Enter)",children:h?e.jsx("div",{className:"w-4 h-4 border-2 border-accent-600 border-t-transparent rounded-full animate-spin"}):e.jsx(me,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:l,disabled:h,className:"p-1 text-primary-500 hover:text-primary-700 hover:bg-primary-100 rounded transition-colors disabled:opacity-50",title:"å–æ¶ˆ (Esc)",children:e.jsx(B,{className:"w-4 h-4"})})]})},Ut=({tags:t,availableTags:r,onSave:l,onCancel:s,maxTags:x=10,placeholder:i="æ·»åŠ æ ‡ç­¾...",className:p=""})=>{const[c,d]=m.useState([...t]),[h,f]=m.useState(""),[C,b]=m.useState(!1),[u,w]=m.useState(!1),[o,j]=m.useState(-1),k=m.useRef(null),D=m.useRef(null),g=r.filter(a=>a.toLowerCase().includes(h.toLowerCase())&&!c.includes(a)&&h.trim().length>0);m.useEffect(()=>{k.current?.focus()},[]);const M=async()=>{if(JSON.stringify(c.sort())===JSON.stringify(t.sort())){s();return}try{w(!0),await l(c),E.success("æ ‡ç­¾ä¿å­˜æˆåŠŸ")}catch(a){console.error("Save tags failed:",a),E.error("ä¿å­˜æ ‡ç­¾å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{w(!1)}},A=a=>{const y=a.trim();if(y){if(c.includes(y)){E.error("æ ‡ç­¾å·²å­˜åœ¨");return}if(c.length>=x){E.error(`æœ€å¤šåªèƒ½æ·»åŠ  ${x} ä¸ªæ ‡ç­¾`);return}if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(y)){E.error("æ ‡ç­¾åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸­æ–‡ã€ä¸‹åˆ’çº¿å’Œæ¨ªçº¿");return}if(y.length>20){E.error("æ ‡ç­¾é•¿åº¦ä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦");return}d(N=>[...N,y]),f(""),b(!1),j(-1)}},L=a=>{d(y=>y.filter(N=>N!==a))},T=a=>{a.key==="Enter"?(a.preventDefault(),o>=0&&g.length>0?A(g[o]):h.trim()&&A(h)):a.key==="Escape"?C?(b(!1),j(-1)):s():a.key==="ArrowDown"?(a.preventDefault(),g.length>0&&j(y=>y<g.length-1?y+1:0)):a.key==="ArrowUp"?(a.preventDefault(),g.length>0&&j(y=>y>0?y-1:g.length-1)):a.key==="Backspace"&&h===""&&c.length>0?d(y=>y.slice(0,-1)):a.key==="s"&&(a.ctrlKey||a.metaKey)&&(a.preventDefault(),M())},P=a=>{const y=a.target.value;f(y),b(y.trim().length>0),j(-1)},O=a=>{A(a)},n=a=>{const y=["bg-blue-100 text-blue-800 border-blue-200","bg-green-100 text-green-800 border-green-200","bg-yellow-100 text-yellow-800 border-yellow-200","bg-purple-100 text-purple-800 border-purple-200","bg-pink-100 text-pink-800 border-pink-200","bg-indigo-100 text-indigo-800 border-indigo-200"];let N=0;for(let S=0;S<a.length;S++)N=a.charCodeAt(S)+((N<<5)-N);return y[Math.abs(N)%y.length]};return e.jsxs("div",{className:`border border-accent-300 rounded-lg bg-white ${p}`,style:{position:"relative"},children:[e.jsxs("div",{className:"p-3 min-h-[60px]",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[c.map((a,y)=>e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-sm font-medium rounded-full border ${n(a)}`,children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),a,e.jsx("button",{type:"button",onClick:()=>L(a),className:"ml-1 hover:text-red-600 transition-colors",title:"åˆ é™¤æ ‡ç­¾",children:e.jsx(B,{className:"w-3 h-3"})})]},y)),c.length<x&&e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:k,type:"text",value:h,onChange:P,onKeyDown:T,onFocus:()=>h.trim()&&b(!0),onBlur:()=>{setTimeout(()=>b(!1),200)},placeholder:c.length===0?i:"",className:"px-2 py-1 text-sm border border-primary-300 rounded focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500 min-w-[120px]",disabled:u}),h.trim()&&e.jsx("button",{type:"button",onClick:()=>A(h),className:"ml-1 p-1 text-accent-600 hover:text-accent-700 hover:bg-accent-50 rounded transition-colors",title:"æ·»åŠ æ ‡ç­¾",children:e.jsx(Q,{className:"w-3 h-3"})}),C&&g.length>0&&e.jsx("div",{ref:D,className:"absolute top-full left-0 right-0 mt-1 bg-white border border-primary-300 rounded-lg shadow-lg z-50 max-h-40 overflow-y-auto",children:g.map((a,y)=>e.jsxs("button",{type:"button",onClick:()=>O(a),className:`w-full text-left px-3 py-2 text-sm hover:bg-primary-50 transition-colors ${y===o?"bg-accent-50 text-accent-700":"text-primary-900"}`,children:[e.jsx(ee,{className:"w-3 h-3 mr-1 inline"}),a]},a))})]})]}),e.jsxs("div",{className:"text-xs text-primary-500",children:[c.length,"/",x," ä¸ªæ ‡ç­¾",c.length<x&&e.jsx("span",{className:"ml-2",children:"â€¢ Enter æ·»åŠ  â€¢ Backspace åˆ é™¤ â€¢ â†‘â†“ é€‰æ‹©å»ºè®®"})]})]}),e.jsxs("div",{className:"bg-primary-50 border-t border-primary-200 px-3 py-2 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-primary-500",children:"Ctrl+S ä¿å­˜ â€¢ Esc å–æ¶ˆ"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{type:"button",onClick:s,disabled:u,className:"px-3 py-1 text-sm text-primary-600 hover:text-primary-800 hover:bg-primary-100 rounded transition-colors disabled:opacity-50",children:[e.jsx(B,{className:"w-4 h-4 mr-1 inline"}),"å–æ¶ˆ"]}),e.jsxs("button",{type:"button",onClick:M,disabled:u,className:"px-3 py-1 text-sm bg-accent-500 text-white hover:bg-accent-600 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[u?e.jsx("div",{className:"w-4 h-4 mr-1 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(me,{className:"w-4 h-4 mr-1"}),"ä¿å­˜"]})]})]})]})},Gt=({cards:t,onCardClick:r,onEditCard:l,onDeleteCard:s,onUpdateCard:x,selectedCards:i=new Set,onSelectCard:p,onSelectAll:c})=>{const[d,h]=m.useState("due"),[f,C]=m.useState("asc"),[b,u]=m.useState(null),w=n=>{if(!n.note)return"å†…å®¹åŠ è½½ä¸­...";const a=n.note.fields;switch(n.cardType){case"CtoE":return a.CtoE?.chinese||"æ— å†…å®¹";case"Retranslate":return a.Retranslate?.originalText||"æ— å†…å®¹";default:return"æœªçŸ¥å¡ç‰‡ç±»å‹"}},o=n=>{switch(n){case"New":return"bg-blue-100 text-blue-800";case"Learning":return"bg-yellow-100 text-yellow-800";case"Review":return"bg-green-100 text-green-800";case"Relearning":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=n=>{switch(n){case"New":return"æ–°å¡ç‰‡";case"Learning":return"å­¦ä¹ ä¸­";case"Review":return"å¤ä¹ ä¸­";case"Relearning":return"é‡æ–°å­¦ä¹ ";default:return n}},k=m.useMemo(()=>[...t].sort((a,y)=>{let N,S;switch(d){case"content":N=w(a).toLowerCase(),S=w(y).toLowerCase();break;case"state":N=a.state,S=y.state;break;case"due":N=new Date(a.due).getTime(),S=new Date(y.due).getTime();break;case"reps":N=a.reps,S=y.reps;break;case"lapses":N=a.lapses,S=y.lapses;break;case"tags":N=a.note?.tags?.join("")||"",S=y.note?.tags?.join("")||"";break;case"created":N=new Date(a.createdAt).getTime(),S=new Date(y.createdAt).getTime();break;default:return 0}return N<S?f==="asc"?-1:1:N>S?f==="asc"?1:-1:0}),[t,d,f]),D=n=>{d===n?C(f==="asc"?"desc":"asc"):(h(n),C("asc"))},g=({field:n,children:a})=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-primary-600 uppercase tracking-wider cursor-pointer hover:bg-primary-100 transition-colors",onClick:()=>D(n),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:a}),d===n?f==="asc"?e.jsx(Be,{className:"w-4 h-4"}):e.jsx(Oe,{className:"w-4 h-4"}):e.jsx("div",{className:"w-4 h-4"})]})}),M=t.length>0&&t.every(n=>i.has(n.id)),A=t.some(n=>i.has(n.id)),L=m.useMemo(()=>{const n=new Set;return t.forEach(a=>{a.note?.tags?.forEach(y=>n.add(y))}),Array.from(n).sort()},[t]),T=(n,a)=>{x&&u({cardId:n,field:a})},P=async(n,a,y)=>{if(x)try{if(a==="tags")await x(n,{note:{tags:y}});else if(a==="content"){const N=t.find(S=>S.id===n);if(N?.note){const S={note:{fields:{...N.note.fields}}};switch(N.cardType){case"CtoE":S.note.fields.CtoE={...S.note.fields.CtoE,chinese:y};break;case"Retranslate":S.note.fields.Retranslate={...S.note.fields.Retranslate,originalText:y};break}await x(n,S)}}u(null)}catch(N){throw console.error("Failed to update card:",N),N}},O=()=>{u(null)};return e.jsxs("div",{className:"bg-white shadow-industrial rounded-lg overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-primary-200",children:[e.jsx("thead",{className:"bg-primary-50",children:e.jsxs("tr",{children:[p&&e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx("input",{type:"checkbox",checked:M,ref:n=>{n&&(n.indeterminate=A&&!M)},onChange:n=>c?.(n.target.checked),className:"rounded border-primary-300 text-accent-600 focus:ring-accent-500"})}),e.jsx(g,{field:"content",children:"å†…å®¹"}),e.jsx(g,{field:"state",children:"çŠ¶æ€"}),e.jsx(g,{field:"due",children:"åˆ°æœŸæ—¶é—´"}),e.jsx(g,{field:"tags",children:"æ ‡ç­¾"}),e.jsx(g,{field:"reps",children:"å¤ä¹ æ¬¡æ•°"}),e.jsx(g,{field:"lapses",children:"é—å¿˜æ¬¡æ•°"}),e.jsx(g,{field:"created",children:"åˆ›å»ºæ—¶é—´"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-primary-600 uppercase tracking-wider",children:"æ“ä½œ"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-primary-200",children:k.map(n=>e.jsxs("tr",{className:"hover:bg-primary-50 cursor-pointer transition-colors",onClick:()=>r(n),children:[p&&e.jsx("td",{className:"px-4 py-4",onClick:a=>a.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:i.has(n.id),onChange:a=>p(n.id,a.target.checked),className:"rounded border-primary-300 text-accent-600 focus:ring-accent-500"})}),e.jsx("td",{className:"px-4 py-4",children:b?.cardId===n.id&&b?.field==="content"?e.jsx(Kt,{value:w(n),onSave:a=>P(n.id,"content",a),onCancel:O,multiline:!0,maxLength:200,placeholder:"ç¼–è¾‘å¡ç‰‡å†…å®¹...",className:"max-w-xs"}):e.jsx("div",{className:"text-sm text-primary-900 line-clamp-2 max-w-xs cursor-pointer hover:bg-primary-50 rounded p-1 transition-colors",onClick:a=>{a.stopPropagation(),T(n.id,"content")},title:"ç‚¹å‡»ç¼–è¾‘å†…å®¹",children:w(n)})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${o(n.state)}`,children:j(n.state)})}),e.jsxs("td",{className:"px-4 py-4",children:[e.jsx("div",{className:"text-sm text-primary-900",children:Me(n.due)}),e.jsx("div",{className:"text-xs text-primary-500",children:pe(n.due)})]}),e.jsx("td",{className:"px-4 py-4",children:b?.cardId===n.id&&b?.field==="tags"?e.jsx(Ut,{tags:n.note?.tags||[],availableTags:L,onSave:a=>P(n.id,"tags",a),onCancel:O,maxTags:5,placeholder:"æ·»åŠ æ ‡ç­¾...",className:"min-w-[200px]"}):e.jsx("div",{className:"flex flex-wrap gap-1 cursor-pointer hover:bg-primary-50 rounded p-1 transition-colors min-h-[24px]",onClick:a=>{a.stopPropagation(),T(n.id,"tags")},title:"ç‚¹å‡»ç¼–è¾‘æ ‡ç­¾",children:n.note?.tags?.map((a,y)=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium bg-accent-100 text-accent-800 rounded-full",children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),a]},y))||e.jsx("span",{className:"text-xs text-primary-400",children:"ç‚¹å‡»æ·»åŠ æ ‡ç­¾"})})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center text-sm text-primary-900",children:[e.jsx(fe,{className:"w-4 h-4 mr-1 text-primary-400"}),n.reps]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-sm text-primary-900",children:n.lapses})}),e.jsx("td",{className:"px-4 py-4",children:e.jsx("div",{className:"text-sm text-primary-500",children:pe(n.createdAt)})}),e.jsx("td",{className:"px-4 py-4",onClick:a=>a.stopPropagation(),children:e.jsxs("div",{className:"flex items-center space-x-2",children:[l&&e.jsx("button",{onClick:()=>l(n),className:"p-1 text-primary-500 hover:text-accent-600 hover:bg-primary-100 rounded transition-colors",title:"ç¼–è¾‘å¡ç‰‡",children:e.jsx(ye,{className:"w-4 h-4"})}),s&&e.jsx("button",{onClick:()=>s(n),className:"p-1 text-primary-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"åˆ é™¤å¡ç‰‡",children:e.jsx(te,{className:"w-4 h-4"})})]})})]},n.id))})]})}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ue,{className:"w-16 h-16 mx-auto text-primary-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"æš‚æ— å¡ç‰‡"}),e.jsx("p",{className:"text-primary-600",children:"æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å¡ç‰‡"})]})]})},Ce=[{value:"New",label:"æ–°å¡ç‰‡",color:"bg-blue-100 text-blue-800"},{value:"Learning",label:"å­¦ä¹ ä¸­",color:"bg-yellow-100 text-yellow-800"},{value:"Review",label:"å¤ä¹ ä¸­",color:"bg-green-100 text-green-800"},{value:"Relearning",label:"é‡æ–°å­¦ä¹ ",color:"bg-red-100 text-red-800"}],Wt=({cards:t,onFilterChange:r,onFilterStateChange:l})=>{const[s,x]=m.useState({search:"",tags:[],states:[],dueDateRange:{start:"",end:""}}),[i,p]=m.useState(!1),c=Ae.useMemo(()=>{const o=new Set;return t.forEach(j=>{j.note?.tags?.forEach(k=>o.add(k))}),Array.from(o).sort()},[t]),d=m.useCallback(o=>{if(!o.note)return"";const j=o.note.fields;let k="";switch(o.cardType){case"CtoE":k=`${j.CtoE?.chinese||""} ${j.CtoE?.english||""}`;break;case"Retranslate":k=`${j.Retranslate?.originalText||""} ${j.Retranslate?.userTranslation||""}`;break;default:k=JSON.stringify(j)}const D=o.note.tags?.join(" ")||"";return`${k} ${D}`.toLowerCase()},[]),h=m.useCallback(()=>{let o=[...t];if(s.search.trim()){const j=s.search.toLowerCase().trim();o=o.filter(k=>d(k).includes(j))}s.tags.length>0&&(o=o.filter(j=>s.tags.every(k=>j.note?.tags?.includes(k)))),s.states.length>0&&(o=o.filter(j=>s.states.includes(j.state))),(s.dueDateRange.start||s.dueDateRange.end)&&(o=o.filter(j=>{const k=new Date(j.due),D=s.dueDateRange.start?new Date(s.dueDateRange.start):null,g=s.dueDateRange.end?new Date(s.dueDateRange.end):null;return!(D&&k<D||g&&k>g)})),r(o)},[t,s,d,r]);m.useEffect(()=>{h(),l?.(s)},[s,h,l]);const f=o=>{x(j=>({...j,...o}))},C=()=>{x({search:"",tags:[],states:[],dueDateRange:{start:"",end:""}})},b=o=>{f({tags:s.tags.includes(o)?s.tags.filter(j=>j!==o):[...s.tags,o]})},u=o=>{f({states:s.states.includes(o)?s.states.filter(j=>j!==o):[...s.states,o]})},w=[s.search.trim()?1:0,s.tags.length,s.states.length,s.dueDateRange.start||s.dueDateRange.end?1:0].reduce((o,j)=>o+j,0);return e.jsxs("div",{className:"bg-white border border-primary-200 rounded-lg p-4 mb-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Ze,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-primary-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"æœç´¢å¡ç‰‡å†…å®¹ã€æ ‡ç­¾...",value:s.search,onChange:o=>f({search:o.target.value}),className:"w-full pl-10 pr-4 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500 focus:border-accent-500"})]}),e.jsxs("button",{onClick:()=>p(!i),className:`flex items-center space-x-2 px-4 py-2 border rounded-lg transition-colors ${i?"bg-accent-50 border-accent-300 text-accent-700":"border-primary-300 text-primary-600 hover:bg-primary-50"}`,children:[e.jsx(Ve,{className:"w-4 h-4"}),e.jsx("span",{children:"é«˜çº§è¿‡æ»¤"}),w>0&&e.jsx("span",{className:"bg-accent-500 text-white text-xs px-2 py-1 rounded-full",children:w})]}),w>0&&e.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-3 py-2 text-red-600 hover:bg-red-50 border border-red-300 rounded-lg transition-colors",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"æ¸…é™¤"})]})]}),i&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-primary-200",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-primary-700 mb-2 flex items-center",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"æ ‡ç­¾è¿‡æ»¤"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.map(o=>e.jsxs("button",{onClick:()=>b(o),className:`inline-flex items-center px-3 py-1 text-sm font-medium rounded-full transition-colors ${s.tags.includes(o)?"bg-accent-100 text-accent-800 border-2 border-accent-300":"bg-primary-100 text-primary-700 border-2 border-transparent hover:border-primary-300"}`,children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),o,s.tags.includes(o)&&e.jsx(B,{className:"w-3 h-3 ml-1"})]},o)),c.length===0&&e.jsx("span",{className:"text-sm text-primary-500",children:"æš‚æ— å¯ç”¨æ ‡ç­¾"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-primary-700 mb-2 flex items-center",children:[e.jsx(fe,{className:"w-4 h-4 mr-1"}),"å¡ç‰‡çŠ¶æ€"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ce.map(o=>e.jsxs("button",{onClick:()=>u(o.value),className:`inline-flex items-center px-3 py-1 text-sm font-medium rounded-full transition-colors border-2 ${s.states.includes(o.value)?`${o.color} border-current`:"bg-primary-100 text-primary-700 border-transparent hover:border-primary-300"}`,children:[o.label,s.states.includes(o.value)&&e.jsx(B,{className:"w-3 h-3 ml-1"})]},o.value))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-primary-700 mb-2 flex items-center",children:[e.jsx(ue,{className:"w-4 h-4 mr-1"}),"åˆ°æœŸæ—¥æœŸèŒƒå›´"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"date",value:s.dueDateRange.start,onChange:o=>f({dueDateRange:{...s.dueDateRange,start:o.target.value}}),className:"px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500 focus:border-accent-500"}),e.jsx("span",{className:"text-primary-500",children:"åˆ°"}),e.jsx("input",{type:"date",value:s.dueDateRange.end,onChange:o=>f({dueDateRange:{...s.dueDateRange,end:o.target.value}}),className:"px-3 py-2 border border-primary-300 rounded-lg focus:ring-2 focus:ring-accent-500 focus:border-accent-500"})]})]})]}),w>0&&e.jsx("div",{className:"mt-4 pt-4 border-t border-primary-200",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-primary-600",children:"å·²åº”ç”¨è¿‡æ»¤å™¨:"}),s.search.trim()&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-accent-100 text-accent-800 rounded",children:['æœç´¢: "',s.search.trim(),'"',e.jsx("button",{onClick:()=>f({search:""}),className:"ml-1 hover:text-accent-600",children:e.jsx(B,{className:"w-3 h-3"})})]}),s.tags.map(o=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-accent-100 text-accent-800 rounded",children:["#",o,e.jsx("button",{onClick:()=>b(o),className:"ml-1 hover:text-accent-600",children:e.jsx(B,{className:"w-3 h-3"})})]},o)),s.states.map(o=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-accent-100 text-accent-800 rounded",children:[Ce.find(j=>j.value===o)?.label||o,e.jsx("button",{onClick:()=>u(o),className:"ml-1 hover:text-accent-600",children:e.jsx(B,{className:"w-3 h-3"})})]},o)),(s.dueDateRange.start||s.dueDateRange.end)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-accent-100 text-accent-800 rounded",children:["æ—¥æœŸ: ",s.dueDateRange.start||"..."," - ",s.dueDateRange.end||"...",e.jsx("button",{onClick:()=>f({dueDateRange:{start:"",end:""}}),className:"ml-1 hover:text-accent-600",children:e.jsx(B,{className:"w-3 h-3"})})]})]})})]})},Xt=({deckId:t,onBack:r,onStartLearning:l,onCreateNote:s})=>{const[x,i]=m.useState(null),[p,c]=m.useState([]),[d,h]=m.useState([]),[f,C]=m.useState(!0),[b,u]=m.useState(null),[w,o]=m.useState(!1),[j,k]=m.useState("table"),[D,g]=m.useState(new Set),[M,A]=m.useState(null),[L,T]=m.useState(0),P=new oe;m.useEffect(()=>{O()},[t]);const O=async()=>{try{C(!0),console.log("Loading deck:",t);const v=await P.getDeckById(t);console.log("Deck data received:",v),i(v),console.log("Loading cards for deck:",t);const R=await P.getCardsByDeckId(t);if(console.log("Cards data received:",R.length,"cards"),R.length>0){const F=R[0];console.log("Sample card structure:",{id:F.id,due:F.due,dueType:typeof F.due,state:F.state})}const z=await Promise.all(R.map(async F=>{try{const ae=await P.getNoteById(F.noteId);return{...F,note:ae}}catch(ae){return console.error(`Failed to load note for card ${F.id}:`,ae),E.error(`åŠ è½½å¡ç‰‡ ${F.id} çš„å†…å®¹å¤±è´¥`),F}}));console.log("Cards with notes loaded successfully:",z.length);const H=new Date,K=z.filter(F=>F.state==="New"?!0:F.due?new Date(F.due)<=H:!1);T(K.length),c(z),h(z)}catch(v){console.error("Failed to load deck and cards:",v),v instanceof Error?v.message.includes("not found")?E.error("ç‰Œç»„ä¸å­˜åœ¨æˆ–å·²è¢«åˆ é™¤"):v.message.includes("Database not initialized")?E.error("æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œè¯·é‡æ–°åŠ è½½é¡µé¢"):E.error(`åŠ è½½å¤±è´¥: ${v.message}`):E.error("åŠ è½½ç‰Œç»„å†…å®¹å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{C(!1)}},n=()=>{l(t)},a=()=>{s(t)},y=v=>{u(v),o(!0)},N=v=>{E.success("ç¼–è¾‘åŠŸèƒ½å³å°†æ¨å‡º")},S=v=>{E.success("åˆ é™¤åŠŸèƒ½å³å°†æ¨å‡º")},q=(v,R)=>{const z=new Set(D);R?z.add(v):z.delete(v),g(z)},Te=v=>{g(v?new Set(d.map(R=>R.id)):new Set)},Fe=v=>{h(v),g(new Set)},Le=async(v,R)=>{try{const z=p.map(H=>{if(H.id===v){const K={...H};return R.note&&H.note&&(K.note={...H.note,...R.note,fields:R.note.fields?{...H.note.fields,...R.note.fields}:H.note.fields,tags:R.note.tags!==void 0?R.note.tags:H.note.tags}),Object.keys(R).forEach(F=>{F!=="note"&&(K[F]=R[F])}),K}return H});c(z),h(H=>H.map(K=>z.find(F=>F.id===K.id)||K)),E.success("å¡ç‰‡æ›´æ–°æˆåŠŸ")}catch(z){throw console.error("Failed to update card:",z),E.error("æ›´æ–°å¡ç‰‡å¤±è´¥ï¼Œè¯·é‡è¯•"),z}},be=v=>{switch(v){case"New":return"bg-blue-100 text-blue-800";case"Learning":return"bg-yellow-100 text-yellow-800";case"Review":return"bg-green-100 text-green-800";case"Relearning":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},je=v=>{if(!v.note)return"å†…å®¹åŠ è½½ä¸­...";const R=v.note.fields;switch(v.cardType){case"CtoE":return R.CtoE?.chinese||"æ— å†…å®¹";case"Retranslate":return R.Retranslate?.originalText||"æ— å†…å®¹";default:return"æœªçŸ¥å¡ç‰‡ç±»å‹"}};return f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center space-x-3 text-primary-600",children:[e.jsx(le,{className:"w-6 h-6 animate-pulse"}),e.jsx("span",{className:"text-lg font-medium",children:"åŠ è½½å¡ç‰‡ä¸­..."})]})}):x?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:r,className:"p-2 text-primary-500 hover:text-primary-700 hover:bg-primary-100 rounded-lg transition-colors",title:"è¿”å›ç‰Œç»„åˆ—è¡¨",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-primary-900",children:x.name}),x.description&&e.jsx("p",{className:"text-primary-600 mt-1",children:x.description}),e.jsxs("p",{className:"text-sm text-primary-500 mt-1",children:["å…± ",p.length," å¼ å¡ç‰‡",M&&d.length!==p.length&&e.jsxs("span",{className:"ml-2 text-accent-600",children:["(å·²è¿‡æ»¤æ˜¾ç¤º ",d.length," å¼ )"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center bg-primary-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>k("table"),className:`p-2 rounded-md transition-colors ${j==="table"?"bg-white text-primary-900 shadow-sm":"text-primary-600 hover:text-primary-900"}`,title:"è¡¨æ ¼è§†å›¾",children:e.jsx(We,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>k("grid"),className:`p-2 rounded-md transition-colors ${j==="grid"?"bg-white text-primary-900 shadow-sm":"text-primary-600 hover:text-primary-900"}`,title:"ç½‘æ ¼è§†å›¾",children:e.jsx(_e,{className:"w-4 h-4"})})]}),D.size>0&&e.jsxs("span",{className:"px-3 py-1 bg-accent-100 text-accent-800 rounded-full text-sm",children:["å·²é€‰æ‹© ",D.size," å¼ å¡ç‰‡"]}),e.jsxs("button",{onClick:a,className:"btn-accent flex items-center space-x-2",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"æ–°å»ºå¡ç‰‡"})]}),e.jsxs("button",{onClick:n,disabled:L===0,className:`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors ${L>0?"bg-accent-500 hover:bg-accent-600 text-white":"bg-primary-200 text-primary-500 cursor-not-allowed"}`,title:L>0?"å¼€å§‹å¤ä¹ å¡ç‰‡":"æš‚æ— åˆ°æœŸå¡ç‰‡",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:L>0?`å¤ä¹ å¡ç‰‡ (${L})`:"æš‚æ— å¤ä¹ "})]})]})]}),p.length>0&&e.jsx(Wt,{cards:p,onFilterChange:Fe,onFilterStateChange:A}),p.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(G,{className:"w-20 h-20 mx-auto text-primary-400 mb-6"}),e.jsx("h3",{className:"text-xl font-semibold text-primary-900 mb-3",children:"æš‚æ— å¡ç‰‡"}),e.jsx("p",{className:"text-primary-600 mb-8 max-w-md mx-auto",children:"è¿™ä¸ªç‰Œç»„è¿˜æ²¡æœ‰å¡ç‰‡ã€‚åˆ›å»ºç¬¬ä¸€å¼ å¡ç‰‡å¼€å§‹å­¦ä¹ å§ï¼"}),e.jsx("button",{onClick:a,className:"btn-primary",children:"åˆ›å»ºç¬¬ä¸€å¼ å¡ç‰‡"})]}):j==="table"?e.jsx(Gt,{cards:d,onCardClick:y,onEditCard:N,onDeleteCard:S,onUpdateCard:Le,selectedCards:D,onSelectCard:q,onSelectAll:Te}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(v=>e.jsxs("div",{className:"card-industrial-hover p-4 cursor-pointer group",onClick:()=>y(v),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${be(v.state)}`,children:v.state==="New"?"æ–°å¡ç‰‡":v.state==="Learning"?"å­¦ä¹ ä¸­":v.state==="Review"?"å¤ä¹ ä¸­":"é‡æ–°å­¦ä¹ "}),e.jsxs("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:R=>{R.stopPropagation(),N()},className:"p-1 text-primary-500 hover:text-accent-600 hover:bg-primary-100 rounded transition-colors",title:"ç¼–è¾‘å¡ç‰‡",children:e.jsx(ye,{className:"w-3 h-3"})}),e.jsx("button",{onClick:R=>{R.stopPropagation(),S()},className:"p-1 text-primary-500 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"åˆ é™¤å¡ç‰‡",children:e.jsx(te,{className:"w-3 h-3"})})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-sm text-primary-900 line-clamp-3",children:je(v)})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-primary-500",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{children:["å¤ä¹  ",v.reps," æ¬¡"]}),e.jsxs("span",{children:["é—å¿˜ ",v.lapses," æ¬¡"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ue,{className:"w-3 h-3"}),e.jsx("span",{children:Me(v.due)})]})]})]},v.id))}),w&&b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-primary-900",children:"å¡ç‰‡è¯¦æƒ…"}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 text-primary-500 hover:text-primary-700 hover:bg-primary-100 rounded-lg transition-colors",children:"Ã—"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"çŠ¶æ€"}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${be(b.state)}`,children:b.state==="New"?"æ–°å¡ç‰‡":b.state==="Learning"?"å­¦ä¹ ä¸­":b.state==="Review"?"å¤ä¹ ä¸­":"é‡æ–°å­¦ä¹ "})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"å†…å®¹"}),e.jsx("div",{className:"bg-primary-50 rounded-lg p-3",children:e.jsx("p",{className:"text-primary-900",children:je(b)})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"å¤ä¹ æ¬¡æ•°"}),e.jsx("p",{className:"text-primary-900",children:b.reps})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"é—å¿˜æ¬¡æ•°"}),e.jsx("p",{className:"text-primary-900",children:b.lapses})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"ç¨³å®šæ€§"}),e.jsx("p",{className:"text-primary-900",children:b.stability.toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"éš¾åº¦"}),e.jsx("p",{className:"text-primary-900",children:b.difficulty.toFixed(2)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-primary-700 mb-1",children:"ä¸‹æ¬¡å¤ä¹ "}),e.jsx("p",{className:"text-primary-900",children:pe(b.due)})]})]})]})})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"w-16 h-16 mx-auto text-primary-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"ç‰Œç»„ä¸å­˜åœ¨"}),e.jsx("p",{className:"text-primary-600 mb-4",children:"è¯·æ£€æŸ¥ç‰Œç»„IDæ˜¯å¦æ­£ç¡®"}),e.jsx("button",{onClick:r,className:"btn-primary",children:"è¿”å›é¦–é¡µ"})]})},Zt=()=>{const[t,r]=m.useState("home"),[l,s]=m.useState(null),x=h=>{s(h),r("cardBrowser")},i=h=>{s(h),r("review")},p=h=>{s(h),r("notes")},c=h=>{r(h),(h==="home"||h==="review")&&s(null)},d=()=>{switch(t){case"home":return e.jsx(we,{onDeckSelect:x,onCreateNote:p,onStartReview:i});case"cardBrowser":return l?e.jsx(Xt,{deckId:l,onBack:()=>c("home"),onStartLearning:i,onCreateNote:p}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"w-16 h-16 mx-auto text-primary-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"è¯·å…ˆé€‰æ‹©ç‰Œç»„"}),e.jsx("p",{className:"text-primary-600",children:"ä»é¦–é¡µé€‰æ‹©ä¸€ä¸ªç‰Œç»„æŸ¥çœ‹å¡ç‰‡"}),e.jsx("button",{onClick:()=>c("home"),className:"btn-primary mt-4",children:"è¿”å›é¦–é¡µ"})]});case"notes":return l?e.jsx(qt,{deckId:l,onBack:()=>c("home"),onNoteSaved:()=>{console.log("Note saved successfully")}}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(G,{className:"w-16 h-16 mx-auto text-primary-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"è¯·å…ˆé€‰æ‹©ç‰Œç»„"}),e.jsx("p",{className:"text-primary-600",children:"ä»é¦–é¡µé€‰æ‹©ä¸€ä¸ªç‰Œç»„å¼€å§‹åˆ›å»ºç¬”è®°"}),e.jsx("button",{onClick:()=>c("home"),className:"btn-primary mt-4",children:"è¿”å›é¦–é¡µ"})]});case"review":return e.jsx(Vt,{deckId:l,onBack:()=>c("home")});case"stats":return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(le,{className:"w-16 h-16 mx-auto text-primary-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"å­¦ä¹ ç»Ÿè®¡"}),e.jsx("p",{className:"text-primary-600",children:"å³å°†æ¨å‡º..."})]});case"settings":return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ne,{className:"w-16 h-16 mx-auto text-primary-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-primary-900 mb-2",children:"è®¾ç½®"}),e.jsx("p",{className:"text-primary-600",children:"å³å°†æ¨å‡º..."})]});default:return e.jsx(we,{onDeckSelect:x})}};return e.jsxs("div",{className:"min-h-screen bg-primary-50",children:[e.jsx(Bt,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10B981",secondary:"#fff"}},error:{duration:4e3,iconTheme:{primary:"#EF4444",secondary:"#fff"}}}}),e.jsx("header",{className:"bg-primary-700 text-white shadow-industrial",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Ie,{className:"w-8 h-8"}),e.jsx("h1",{className:"text-xl font-bold",children:"LanGear Language Learning"})]}),e.jsxs("nav",{className:"flex items-center space-x-6",children:[e.jsxs("button",{onClick:()=>c("home"),className:`flex items-center space-x-2 px-3 py-2 rounded-industrial transition-colors ${t==="home"?"bg-primary-600 hover:bg-primary-500":"hover:bg-primary-600"}`,children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{children:"é¦–é¡µ"})]}),e.jsxs("button",{onClick:()=>c("review"),className:`flex items-center space-x-2 px-3 py-2 rounded-industrial transition-colors ${t==="review"?"bg-primary-600 hover:bg-primary-500":"hover:bg-primary-600"}`,children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{children:"å¤ä¹ "})]}),e.jsxs("button",{onClick:()=>c("stats"),className:`flex items-center space-x-2 px-3 py-2 rounded-industrial transition-colors ${t==="stats"?"bg-primary-600 hover:bg-primary-500":"hover:bg-primary-600"}`,children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"ç»Ÿè®¡"})]}),e.jsxs("button",{onClick:()=>c("settings"),className:`flex items-center space-x-2 px-3 py-2 rounded-industrial transition-colors ${t==="settings"?"bg-primary-600 hover:bg-primary-500":"hover:bg-primary-600"}`,children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{children:"è®¾ç½®"})]})]})]})})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:d()})]})},ke=document.getElementById("main-root");ke&&Pe(ke).render(e.jsx(Zt,{}));
